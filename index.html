<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Homothéties — Quiz (16:9)</title>
<style>
  :root{
    --primary:#5b6dfa; --accent:#8000ff;
    --bg:#fafafa; --grid:#e0e0e0;
  }
  body{
    margin:0; background:var(--bg);
    display:flex; height:100vh; font-family:sans-serif;
  }
  /* Colonne gauche (questions) */
  aside{
    width:25%; padding:1rem; overflow-y:auto;
    background:#fff; border-right:2px solid #ddd;
  }
  aside h2{ font-size:1.2rem; margin:0 0 1rem; color:var(--primary) }
  aside ul{ padding-left:1rem; }
  aside li{ margin-bottom:0.6rem; cursor:pointer }
  aside li.active{ font-weight:bold; color:var(--primary) }

  /* Zone centrale */
  main{
    flex:1; display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    padding:1rem;
  }
  #grid{
    width:100%; max-width:960px; aspect-ratio:16/9;
    border:2px solid var(--grid); background:#fff;
  }
  svg{width:100%;height:100%}

  /* Colonne droite (statut) */
  .status{
    width:15%; padding:1rem; border-left:2px solid #ddd;
    display:flex; flex-direction:column; align-items:center;
    justify-content:center; font-weight:bold; color:#444;
  }
</style>
</head>
<body>

<aside>
  <h2>Questions</h2>
  <ul id="qList"></ul>
</aside>

<main>
  <div id="grid"><svg id="svgGrid" viewBox="0 0 1280 720"></svg></div>
</main>

<div class="status" id="status">1 / 10</div>

<script>
/* ---------- Config grille 16:9 ---------- */
const gridSize=40, cols=32, rows=18, width=1280, height=720;
const svg=document.getElementById("svgGrid"), ns="http://www.w3.org/2000/svg";
function el(tag,a={}){const e=document.createElementNS(ns,tag);for(const k in a)e.setAttribute(k,a[k]);return e;}
function clear(){while(svg.firstChild)svg.removeChild(svg.firstChild);}
function grid(){
  for(let i=0;i<=cols;i++) svg.appendChild(el("line",{x1:i*gridSize,y1:0,x2:i*gridSize,y2:height,stroke:"#eee"}));
  for(let j=0;j<=rows;j++) svg.appendChild(el("line",{x1:0,y1:j*gridSize,x2:width,y2:j*gridSize,stroke:"#eee"}));
}
function drawPoly(pts){
  const poly=el("polygon",{points:pts.map(p=>`${p.x},${p.y}`).join(" "),
    fill:"rgba(128,0,255,0.25)", stroke:"#8000ff","stroke-width":2});
  svg.appendChild(poly);
}
function drawPoint(p,c="#000"){svg.appendChild(el("circle",{cx:p.x,cy:p.y,r:6,fill:c,stroke:"#000"}));}
function snap(x,y){return{ x:Math.round(x/gridSize)*gridSize, y:Math.round(y/gridSize)*gridSize };}

/* ---------- Données questions ---------- */
const questions=[
  {type:"rectangle",label:"Homothétie k=1/2",O:{x:400,y:200},pts:[{x:360,y:160},{x:440,y:160},{x:440,y:240},{x:360,y:240}],k:0.5},
  {type:"triangle",label:"Homothétie k=2",O:{x:600,y:300},pts:[{x:560,y:280},{x:600,y:360},{x:640,y:280}],k:2}
];
let current=0,userPts=[],expected=[];

/* ---------- Préparation liste gauche ---------- */
const qList=document.getElementById("qList");
questions.forEach((q,i)=>{
  const li=document.createElement("li");
  li.textContent=(i+1)+". "+q.label;
  li.onclick=()=>render(i);
  qList.appendChild(li);
});

/* ---------- Rendu d'une question ---------- */
function homothetie(O,P,k){return snap(O.x+k*(P.x-O.x), O.y+k*(P.y-O.y));}
function render(idx){
  current=idx; userPts=[]; clear(); grid();
  [...qList.children].forEach((li,i)=>li.classList.toggle("active",i===idx));
  const q=questions[idx];
  drawPoly(q.pts); q.pts.forEach(p=>drawPoint(p,"var(--primary)")); drawPoint(q.O,"#000");
  expected=q.pts.map(p=>homothetie(q.O,p,q.k));
  document.getElementById("status").textContent=`${idx+1} / ${questions.length}`;
}

/* ---------- Interaction ---------- */
svg.addEventListener("click",e=>{
  const rect=svg.getBoundingClientRect();
  const x=(e.clientX-rect.left)*(width/rect.width);
  const y=(e.clientY-rect.top)*(height/rect.height);
  const p=snap(x,y);
  userPts.push(p); drawPoint(p,"#ff6b6b");
  if(userPts.length===expected.length){
    drawPoly(userPts); // affiche la figure de l’élève
  }
});

/* ---------- Init ---------- */
render(0);
</script>
</body>
</html>
