<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Homothéties — Quiz (16:9)</title>

  <!-- Polices -->
  <link href="https://fonts.googleapis.com/css2?family=Androgy+Demo&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Mabry+Pro&display=swap" rel="stylesheet" />

  <style>
    :root{
      --primary:#5b6dfa; --secondary:#00bfa6; --accent:#ff6b6b;
      --bg:#fafafa; --grid:#e0e0e0; --text:#222;
      --radius:10px; --transition:0.25s;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:'Mabry Pro',sans-serif;
      background:var(--bg); color:var(--text);
      display:flex; flex-direction:column; align-items:center;
      padding:1.5rem; gap:1rem;
    }
    h1{
      font-family:'Androgy Demo',sans-serif; color:var(--primary);
      margin:0; font-size:2rem; text-align:center;
    }
    .panel {
      background:white; border-radius:var(--radius); padding:1rem;
      box-shadow:0 6px 14px rgba(0,0,0,0.06);
      width:100%; max-width:1280px;
      display:flex; flex-direction:column; align-items:center; gap:1rem;
    }
    .question-text{ font-size:1.1rem; margin-bottom:0.5rem; color:#333; text-align:center }
    #grid {
      width:100%; aspect-ratio:16/9;
      border:2px solid var(--grid);
      border-radius:var(--radius); overflow:hidden;
      background:white;
    }
    svg{ width:100%; height:100%; display:block }
    .btn{
      padding:0.6rem 1.1rem; border-radius:10px; border:none; cursor:pointer;
      background:var(--primary); color:white; font-weight:700;
      transition:all var(--transition);
    }
    .btn.secondary{ background:var(--secondary) }
    .small { padding:0.4rem 0.8rem; font-size:0.95rem; }
    .status { font-weight:700; font-size:0.95rem; color:#444 }
    footer { margin-top:0.5rem; font-size:0.85rem; color:#666 }
  </style>
</head>
<body>

  <h1>Homothéties — Quiz (16:9)</h1>

  <div class="panel">
    <div class="question-text" id="qText">Chargement…</div>
    <div class="status" id="status">Question 1 / 10</div>
    <div id="grid"><svg id="svgGrid" viewBox="0 0 1280 720" preserveAspectRatio="xMidYMid meet"></svg></div>
    <div style="display:flex;gap:0.6rem;flex-wrap:wrap;justify-content:center">
      <button class="btn small" id="checkBtn">Vérifier</button>
      <button class="btn small secondary" id="nextBtn">Question suivante</button>
      <button class="btn small" id="resetBtn">Réinitialiser</button>
    </div>
  </div>

  <footer>Grille : 32 × 18 cases — format 16/9</footer>

<script>
/* --------- Configuration grille --------- */
const gridSize = 40;
const cols = 32;
const rows = 18;
const width = cols * gridSize;  //1280
const height = rows * gridSize; //720
const tol = 8; // tolérance px

/* --------- Questions --------- */
const questions = [
  { type:'rectangle', label:"Construis A',B',C',D' par homothétie de centre O et rapport 1/2.",
    O:{x:400,y:200}, pts:[{x:360,y:160},{x:440,y:160},{x:440,y:240},{x:360,y:240}], k:1/2 },
  { type:'triangle', label:"Construis A',B',C' par homothétie de centre O et rapport 2.",
    O:{x:600,y:300}, pts:[{x:560,y:280},{x:600,y:360},{x:640,y:280}], k:2 }
];

/* --------- Setup --------- */
const ns = "http://www.w3.org/2000/svg";
const svg = document.getElementById('svgGrid');
svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
function el(tag, attrs={}){const e=document.createElementNS(ns,tag);for(const k in attrs)e.setAttribute(k,attrs[k]);return e;}
function drawGrid(){
  for(let i=0;i<=cols;i++){
    svg.appendChild(el('line',{x1:i*gridSize,y1:0,x2:i*gridSize,y2:height,stroke:'#eee'}));
  }
  for(let j=0;j<=rows;j++){
    svg.appendChild(el('line',{x1:0,y1:j*gridSize,x2:width,y2:j*gridSize,stroke:'#eee'}));
  }
}
function clearSVG(){while(svg.firstChild)svg.removeChild(svg.firstChild);}

/* --------- Helpers --------- */
function homothetyPoint(O,P,k){
  return {
    x: Math.round((O.x + k*(P.x-O.x))/gridSize)*gridSize,
    y: Math.round((O.y + k*(P.y-O.y))/gridSize)*gridSize
  };
}
function drawPoly(pts, color){
  const poly=el('polygon',{points:pts.map(p=>`${p.x},${p.y}`).join(' '),
    fill:color,stroke:'#000','stroke-width':2,opacity:0.3});
  svg.appendChild(poly);
}
function drawPoint(p,color,r=6){svg.appendChild(el('circle',{cx:p.x,cy:p.y,r,fill:color,stroke:'#000','stroke-width':0.6}));}

/* --------- Interaction --------- */
let current=0,userPlaced=[],expected=[],interactive=true;
const qText=document.getElementById('qText');
const status=document.getElementById('status');
function renderQuestion(idx){
  current=idx;userPlaced=[];interactive=true;clearSVG();drawGrid();
  const q=questions[idx];
  qText.textContent=q.label;
  status.textContent=`Question ${idx+1} / ${questions.length}`;
  drawPoly(q.pts,'var(--primary)'); q.pts.forEach(p=>drawPoint(p,'var(--primary)'));
  drawPoint(q.O,'#000',7);
  expected=q.pts.map(p=>homothetyPoint(q.O,p,q.k));
}
svg.addEventListener('click',e=>{
  if(!interactive)return;
  const rect=svg.getBoundingClientRect(),vb=svg.viewBox.baseVal;
  const x=(e.clientX-rect.left)*(vb.width/rect.width);
  const y=(e.clientY-rect.top)*(vb.height/rect.height);
  const sx=Math.round(x/gridSize)*gridSize,sy=Math.round(y/gridSize)*gridSize;
  userPlaced.push({x:sx,y:sy}); drawPoint({x:sx,y:sy},'var(--accent)');
});
function checkAnswer(){
  if(userPlaced.length!==expected.length){alert("Place tous les points !");return;}
  let ok=true;
  userPlaced.forEach((p,i)=>{
    if(Math.abs(p.x-expected[i].x)>tol||Math.abs(p.y-expected[i].y)>tol)ok=false;
  });
  drawPoly(userPlaced,ok?'limegreen':'red');
  interactive=false;
  alert(ok?"✅ Correct !":"❌ Erreur, essaie encore");
}
document.getElementById('checkBtn').onclick=checkAnswer;
document.getElementById('nextBtn').onclick=()=>renderQuestion((current+1)%questions.length);
document.getElementById('resetBtn').onclick=()=>renderQuestion(current);

/* --------- Init --------- */
renderQuestion(0);
</script>
</body>
</html>
